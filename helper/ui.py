from datetime import datetimeimport streamlit as stdef streamed_response(streamer):    "stream the LLM's response"    with st.spinner('Thinking...'):        for token in streamer.response_gen:            yield token                        def export_chat_history():    "export chat history"    chat_history = f'*{st.session_state["user_name"]}\'s chat history from {str(datetime.now().date())}*\n\n'        counter = 1    for message in st.session_state.messages:        if "source_string" not in message["content"]:            role = message["role"]            if role == "user":                chat_history += f'### {[counter]} {st.session_state["user_name"]}\n\n'            else:                chat_history += f'### {[counter]} LLM\n\n'                            chat_history += f'{message["content"]}\n\n'        # sources        else:            if message["content"] != "source_string:NA":                source_content = message["content"]                source_content = source_content.replace("source_string:", "").replace("### Metadata:", "\n### Metadata:\n").replace("### Text:", "\n### Text:\n").replace(" ```", "```").replace("# Source", f"### {[counter]} Source")                                chat_history += "_**Sources**_:\n"                chat_history += "<details>\n"                chat_history += source_content                chat_history += "</details>\n\n"            counter += 1                return chat_history